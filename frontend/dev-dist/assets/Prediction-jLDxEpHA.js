import{B as lt,j as e,U as ct,D as ut,E as dt,F as ft,G as pt,I as s,J as at,K as ot,L as Oe,M as it,N as Ze,O as mt,P as gt,Q as ht,T as bt,V as rt,W as _,X as kt,Y as et,Z as xt,$ as yt}from"./index-CzYOAarU.js";class St extends lt{constructor({value:v}){super(`Number \`${v}\` is not a valid decimal number.`,{name:"InvalidDecimalNumberError"})}}function Ee(u,v){if(!/^(-?)([0-9]*)\.?([0-9]*)$/.test(u))throw new St({value:u});let[i,d="0"]=u.split(".");const p=i.startsWith("-");if(p&&(i=i.slice(1)),d=d.replace(/(0+)$/,""),v===0)Math.round(+`.${d}`)===1&&(i=`${BigInt(i)+1n}`),d="";else if(d.length>v){const[I,H,N]=[d.slice(0,v-1),d.slice(v-1,v),d.slice(v)],w=Math.round(+`${H}.${N}`);w>9?d=`${BigInt(I)+BigInt(1)}0`.padStart(I.length+1,"0"):d=`${I}${w}`,d.length>v&&(d=d.slice(1),i=`${BigInt(i)+1n}`),d=d.slice(0,v)}else d=d.padEnd(v,"0");return BigInt(`${p?"-":""}${i}${d}`)}const wt=({categoryIcon:u,question:v,yesPercentage:i=70,noPercentage:d=30,votes:p="05",timeLeft:I="20 hrs 56 mins left",showBorder:H=!0,optionA:N="Yes",optionB:w="No"})=>e.jsxs("div",{className:`bg-[#09113b] rounded-xl ${H?"border border-[#18DDF7]":""} px-4 py-2 mt-2 mb-6`,children:[e.jsxs("div",{className:"flex items-center gap-3 mt-2 mb-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-sm bg-[#01052D] flex items-center justify-center text-white text-lg",children:u}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:v})]}),e.jsx("div",{className:"mb-2",children:e.jsxs("div",{className:"relative w-full h-10 rounded-full bg-[#18DDF71A] overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-y-0 flex items-center gap-2 font-semibold text-white left-5",children:[e.jsx("span",{children:N}),e.jsx("img",{src:ct,alt:"Up Icon",className:"w-4 h-4"})]}),e.jsx("div",{className:"absolute inset-y-0 flex items-center font-semibold text-white right-2",children:e.jsxs("span",{children:[i,"%"]})}),e.jsx("div",{className:"h-full bg-[#18DDF7] opacity-50",style:{width:`${i}%`}})]})}),e.jsx("div",{children:e.jsxs("div",{className:"relative w-full h-10 rounded-full bg-[#FF5A5A1A] overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-y-0 flex items-center gap-2 font-semibold text-white left-5",children:[e.jsx("span",{children:w}),e.jsx("img",{src:ut,alt:"Down Icon",className:"w-4 h-4"})]}),e.jsx("div",{className:"absolute inset-y-0 flex items-center font-semibold text-white right-2",children:e.jsxs("span",{children:[d,"%"]})}),e.jsx("div",{className:"h-full bg-[#FF5A5A] opacity-30",style:{width:`${d}%`}})]})}),e.jsx("div",{className:"flex items-center justify-center mt-2",children:e.jsx("span",{className:"text-gray-100",children:I})}),e.jsxs("div",{className:"flex items-center justify-between mt-2 text-sm text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:dt,alt:"User icon"}),e.jsxs("div",{className:"flex items-center gap-2 text-transparent bg-clip-text bg-gradient-to-r from-[#00FFFF] to-[#27FE60]",children:[e.jsx("span",{className:"inline-block w-2 h-2 rounded-full"}),e.jsx("span",{children:p}),e.jsx("span",{children:"Votes"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{children:I}),e.jsx(ft,{data:{text:"Web Share - GfG",url:"https://www.stimapp.com",title:"Preden PVP"},onClick:()=>console.log("shared successfully!"),children:e.jsx("button",{className:"flex items-center justify-center",children:e.jsx("img",{src:pt,alt:"share icon",className:"w-4 h-4"})})})]})]})]}),vt="data:image/svg+xml,%3csvg%20width='15'%20height='14'%20viewBox='0%200%2015%2014'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M7.02176%201.3022C7.17542%200.990908%207.25225%200.835262%207.35655%200.785532C7.44729%200.742266%207.55272%200.742266%207.64347%200.785532C7.74776%200.835262%207.82459%200.990908%207.97825%201.3022L9.43604%204.25551C9.4814%204.34741%209.50408%204.39336%209.53723%204.42904C9.56658%204.46063%209.60177%204.48622%209.64087%204.5044C9.68503%204.52494%209.73573%204.53235%209.83714%204.54717L13.098%205.02379C13.4414%205.07398%2013.6131%205.09908%2013.6925%205.18295C13.7616%205.25592%2013.7942%205.35619%2013.781%205.45584C13.7659%205.57038%2013.6416%205.69144%2013.393%205.93358L11.0343%208.23094C10.9608%208.30255%2010.924%208.33836%2010.9003%208.38096C10.8793%208.41869%2010.8658%208.46013%2010.8606%208.50299C10.8547%208.5514%2010.8634%208.60199%2010.8808%208.70315L11.4373%2011.9481C11.496%2012.2903%2011.5254%2012.4614%2011.4702%2012.563C11.4222%2012.6513%2011.3369%2012.7133%2011.238%2012.7316C11.1244%2012.7527%2010.9707%2012.6719%2010.6634%2012.5103L7.74825%2010.9772C7.65742%2010.9294%207.612%2010.9056%207.56416%2010.8962C7.52179%2010.8879%207.47822%2010.8879%207.43586%2010.8962C7.38801%2010.9056%207.3426%2010.9294%207.25177%2010.9772L4.33661%2012.5103C4.02927%2012.6719%203.8756%2012.7527%203.76198%2012.7316C3.66312%2012.7133%203.57781%2012.6513%203.52982%2012.563C3.47466%2012.4614%203.50401%2012.2903%203.56271%2011.9481L4.11925%208.70315C4.1366%208.60199%204.14528%208.5514%204.13941%208.50299C4.13421%208.46013%204.12074%208.41869%204.09973%208.38096C4.07601%208.33836%204.03925%208.30255%203.96572%208.23094L1.60703%205.93358C1.35844%205.69144%201.23414%205.57038%201.21901%205.45584C1.20585%205.35619%201.23836%205.25592%201.3075%205.18295C1.38695%205.09908%201.55864%205.07398%201.90202%205.02379L5.16287%204.54717C5.26428%204.53235%205.31498%204.52494%205.35914%204.5044C5.39824%204.48622%205.43344%204.46063%205.46279%204.42904C5.49593%204.39336%205.51861%204.34741%205.56398%204.25551L7.02176%201.3022Z'%20stroke='%2318DDF7'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",Xe=[{constant:!0,inputs:[],name:"decimals",outputs:[{name:"",type:"uint8"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"owner",type:"address"}],name:"balanceOf",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"owner",type:"address"},{name:"spender",type:"address"}],name:"allowance",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"spender",type:"address"},{name:"value",type:"uint256"}],name:"approve",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"}],Ct=(u,v,i,d=6)=>{const[p,I]=s.useState(!1),[H,N]=s.useState(!1),[w,ee]=s.useState(null),[S,ie]=s.useState(null),[O,fe]=s.useState(null),{writeContractAsync:J}=at(),{isLoading:pe,isSuccess:re}=ot({hash:w,enabled:!!w}),{data:$,refetch:j}=Oe({address:u,abi:Xe,functionName:"allowance",args:[i,v],enabled:!!i&&!!u&&!0}),{data:ae,refetch:te}=Oe({address:u,abi:Xe,functionName:"balanceOf",args:[i],enabled:!!i&&!!u}),se=s.useCallback(b=>{if(!b||!$)return!1;try{const E=Ee(b.toString(),d);return $>=E}catch(E){return console.error("Error comparing allowance:",E),!1}},[$,d]);s.useEffect(()=>{if(S&&$){const b=se(S);I(b),re&&b&&N(!1)}},[$,se,S,re]),s.useEffect(()=>{re&&w&&(console.log("Approval transaction confirmed:",w),ee(null),N(!1),S&&(j(),I(!0)))},[re,w,S,j]);const G=async b=>{var E,n;try{if(!b||Number.parseFloat(b)<=0)throw new Error("Invalid amount");if(!i)throw new Error("Wallet not connected");N(!0),ie(b);const L=Ee(b.toString(),d),U=await J({address:u,abi:Xe,functionName:"approve",args:[v,L]});return ee(U),{success:!0,hash:U}}catch(L){console.error("Approval error:",L),N(!1),ie(null);let U="Approval failed";return(E=L.message)!=null&&E.includes("User rejected")?U="Transaction was rejected":(n=L.message)!=null&&n.includes("insufficient funds")?U="Insufficient funds for gas fee":L.message&&(U=`Approval failed: ${L.message}`),fe(U),{success:!1,error:U}}};return{isApproved:p,pendingApproval:H,isApprovalPending:pe,isApprovalSuccess:re,userBalance:ae||BigInt(0),allowance:$,error:O,approveToken:G,checkIfApproved:se,refetchAllowance:j,refetchBalance:te,setError:fe,clearError:()=>fe(null)}},At=[{type:"function",name:"stake",inputs:[{name:"_option",type:"uint8",internalType:"uint8"},{name:"_amount",type:"uint256",internalType:"uint256"}],outputs:[],stateMutability:"nonpayable"}],Nt=(u,v,i=18)=>{const[d,p]=s.useState(!1),[I,H]=s.useState(null),[N,w]=s.useState(null),[ee,S]=s.useState(null),[ie,O]=s.useState(!1),{writeContractAsync:fe,error:J,isPending:pe}=at(),{isLoading:re,isSuccess:$,error:j}=ot({hash:I,enabled:!!I});return s.useEffect(()=>{$&&I&&!ie&&(console.log("‚úÖ Stake transaction confirmed:",I),O(!0),p(!1),w(null))},[$,I,ie]),s.useEffect(()=>{(J||j)&&(console.error("‚ùå Transaction error:",J||j),p(!1),w((J==null?void 0:J.message)||(j==null?void 0:j.message)||"Transaction failed"))},[J,j]),{pendingStake:d,isStakePending:re||pe,isStakeSuccess:$&&ie,error:N,debugInfo:ee,transactionCompleted:ie,stakeHash:I,placeStake:async(G,b,E,n,L,U,z=null)=>{var V,y,Q,Y,M,he,D,m;try{if(console.log("=== üöÄ STARTING ENHANCED STAKE TRANSACTION ==="),console.log("üìù Input parameters:",{optionValue:G,amount:b,eventAddress:u,userAddress:v,tokenDecimals:i,amountInWei:z==null?void 0:z.toString()}),w(null),S(null),O(!1),!u||!v)throw new Error("Missing required addresses");if(!b||Number.parseFloat(b)<=0)throw new Error("Invalid stake amount");if(G!==0&&G!==1)throw new Error("Invalid option value (must be 0 or 1)");if(E&&(console.log("üîç Event validation:",{status:E.status,isOpenForBetting:E.isOpenForBetting,hasEnded:E.hasEnded}),!E.isOpenForBetting)){let F="Event is not accepting stakes";throw E.isPending?F="Event is still pending approval":E.isClosed||E.isCompleted?F="Event is closed for betting":E.hasEnded&&(F="Event has already ended"),new Error(F)}const h=z||Ee(b.toString(),i);if(console.log("üí∞ Amount conversion:",{originalAmount:b,decimals:i,amountInWei:h.toString()}),n){const F=Number(n)/Math.pow(10,i),x=Number.parseFloat(b);if(console.log("üíº Balance check:",{userBalance:F,stakeAmount:x,hasEnoughBalance:F>=x}),F<x)throw new Error(`Insufficient balance. You have ${F.toFixed(4)} but need ${x}`)}if(L){const F=Number(L)/Math.pow(10,i),x=Number.parseFloat(b);if(console.log("üîì Allowance check:",{allowance:F,stakeAmount:x,hasEnoughAllowance:F>=x}),F<x)throw new Error(`Insufficient allowance. Approved: ${F.toFixed(4)}, needed: ${x}`)}console.log("‚úÖ All validations passed. Proceeding with stake transaction..."),p(!0);const k=Number(G);console.log("üìû Calling stake function:",{contract:u,function:"stake",args:[k,h.toString()]});const T=await fe({address:u,abi:At,functionName:"stake",args:[k,h]});return console.log("‚úÖ Stake transaction submitted:",T),H(T),{success:!0,hash:T,debugInfo:{optionValue:k,amount:h.toString(),eventAddress:u,userAddress:v}}}catch(h){console.error("=== ‚ùå STAKING ERROR ===",h),p(!1),O(!1);let k="Staking failed";if((V=h.message)!=null&&V.includes("User rejected")||(y=h.message)!=null&&y.includes("user rejected"))k="Transaction was rejected by user";else if((Q=h.message)!=null&&Q.includes("insufficient funds"))k="Insufficient ETH for gas fee";else if((Y=h.message)!=null&&Y.includes("execution reverted")||(M=h.message)!=null&&M.includes("reverted")){k="Transaction reverted by smart contract";const T=h.message.toLowerCase();T.includes("event not open")||T.includes("not approved")?k+=" - Event is not open for betting":T.includes("insufficient allowance")||T.includes("allowance")?k+=" - Token allowance insufficient":T.includes("insufficient balance")||T.includes("balance")?k+=" - Token balance insufficient":T.includes("invalid option")?k+=" - Invalid betting option":T.includes("already staked")||T.includes("already placed")?k+=" - User has already placed a stake":T.includes("amount")?k+=" - Invalid stake amount":k+=" - Check event status and your balance"}else(he=h.message)!=null&&he.includes("network")?k="Network error - please try again":(D=h.message)!=null&&D.includes("chainId")||(m=h.message)!=null&&m.includes("chain")?k="Wrong network - please switch to Base Sepolia":h.message&&(k=h.message);return w(k),{success:!1,error:k,debugInfo:{originalError:h.message,stack:h.stack}}}},runDebugCheck:async(G,b,E,n,L,U,z=null)=>{try{console.log("üîç Running debug check...");const V=z||Ee(b.toString(),i),y={inputs:{optionValue:G,amount:b,amountInWei:V.toString(),eventAddress:u,userAddress:v,tokenAddress:U,tokenDecimals:i},validation:{hasValidAddress:!!u&&!!v,hasValidAmount:b&&Number.parseFloat(b)>0,hasValidOption:G===0||G===1,eventIsOpen:(E==null?void 0:E.isOpenForBetting)||!1,hasBalance:n?Number(n)/Math.pow(10,i)>=Number.parseFloat(b):"unknown",hasAllowance:L?Number(L)/Math.pow(10,i)>=Number.parseFloat(b):"unknown"},summary:{canStake:!0,mainBlocker:null}};return y.validation.hasValidAddress?y.validation.hasValidAmount?y.validation.hasValidOption?y.validation.eventIsOpen?y.validation.hasBalance===!1?(y.summary.canStake=!1,y.summary.mainBlocker="Insufficient balance"):y.validation.hasAllowance===!1&&(y.summary.canStake=!1,y.summary.mainBlocker="Insufficient allowance"):(y.summary.canStake=!1,y.summary.mainBlocker="Event is not open for betting"):(y.summary.canStake=!1,y.summary.mainBlocker="Invalid option value"):(y.summary.canStake=!1,y.summary.mainBlocker="Invalid stake amount"):(y.summary.canStake=!1,y.summary.mainBlocker="Missing required addresses"),console.log("üîç Debug result:",y),S(y),y}catch(V){return console.error("‚ùå Debug check failed:",V),{error:V.message,inputs:{optionValue:G,amount:b,eventAddress:u,userAddress:v,tokenAddress:U},summary:{canStake:!1,mainBlocker:"Debug check failed"}}}},clearTransactionState:()=>{console.log("üîÑ Clearing staking transaction state"),H(null),p(!1),O(!1),w(null),S(null)},setError:w,clearError:()=>{w(null),S(null)}}},qe=[{type:"function",name:"getEventDetails",inputs:[],outputs:[{name:"question",type:"string",internalType:"string"},{name:"description",type:"string",internalType:"string"},{name:"options",type:"string[]",internalType:"string[]"},{name:"eventType",type:"string",internalType:"string"},{name:"category",type:"string",internalType:"string"},{name:"eventImage",type:"string",internalType:"string"},{name:"status",type:"uint8",internalType:"enum EventContract.EventStatus"},{name:"endTime",type:"uint256",internalType:"uint256"},{name:"winningOption",type:"uint8",internalType:"uint8"},{name:"creator",type:"address",internalType:"address"},{name:"tokenAddress",type:"address",internalType:"address"},{name:"creatorStake",type:"uint256",internalType:"uint256"},{name:"totalStaked",type:"uint256",internalType:"uint256"},{name:"creatorFeePercentage",type:"uint256",internalType:"uint256"},{name:"creatorRewardClaimed",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"getOptionTotals",inputs:[],outputs:[{name:"",type:"uint256[]",internalType:"uint256[]"}],stateMutability:"view"},{type:"function",name:"getUserStake",inputs:[{name:"_user",type:"address",internalType:"address"}],outputs:[{name:"selectedOption",type:"uint8",internalType:"uint8"},{name:"amount",type:"uint256",internalType:"uint256"},{name:"claimed",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"getStakersCount",inputs:[],outputs:[{name:"",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"stake",inputs:[{name:"_option",type:"uint8",internalType:"uint8"},{name:"_amount",type:"uint256",internalType:"uint256"}],outputs:[],stateMutability:"nonpayable"}],X={PENDING:0,APPROVED:1,CLOSED:2,COMPLETED:3,CANCELLED:4,REJECTED:5,NULLIFIED:5},Et={[X.PENDING]:"Pending approval",[X.APPROVED]:"Open for betting",[X.CLOSED]:"Closed for betting",[X.COMPLETED]:"Completed",[X.CANCELLED]:"Cancelled",[X.REJECTED]:"Rejected",[X.NULLIFIED]:"Nullified"},Ne={["0xdE9e4C3ce781b4bA68120d6261cbad65ce0aB00b".toLowerCase()]:{name:"cUSD",symbol:"cUSD",decimals:18,icon:"cUSD.png"},["0x01C5C0122039549AD1493B8220cABEdD739BC44E".toLowerCase()]:{name:"USDC",symbol:"USDC",decimals:6,icon:"USDC.svg"}},Tt=(u,v,i)=>{const{address:d}=it(),[p,I]=s.useState(i||null),[H,N]=s.useState([]),[w,ee]=s.useState(v),[S,ie]=s.useState(()=>{const t="0xdE9e4C3ce781b4bA68120d6261cbad65ce0aB00b".toLowerCase();return Ne[t]||Ne["0xdE9e4C3ce781b4bA68120d6261cbad65ce0aB00b".toLowerCase()]}),[O,fe]=s.useState(null),[J,pe]=s.useState(!1),[re,$]=s.useState(!0),[j,ae]=s.useState(null),[te,se]=s.useState(!1),[G,b]=s.useState(!1),[E,n]=s.useState(null),[L,U]=s.useState(null),[z,V]=s.useState(null),[y,Q]=s.useState(null),[Y,M]=s.useState(!1),he=s.useRef(0),D=s.useRef(!1),m=Ct(w,u,d,S.decimals),h=Nt(u,d,S.decimals),k=s.useCallback((t,a=0)=>{if(t==null)return a;if(typeof t=="number"&&!isNaN(t))return t;if(typeof t=="string"){const c=Number.parseFloat(t);return isNaN(c)?a:c}return typeof t=="bigint"?Number(t):a},[]),T=s.useCallback((t,a="")=>t==null?a:typeof t=="string"?t:String(t),[]),F=s.useCallback(t=>!t||t==="0x0"||t==="0x0000000000000000000000000000000000000000"?v:t,[v]),{data:x,isError:le,isLoading:oe,refetch:ce}=Oe({address:u,abi:qe,functionName:"getEventDetails",enabled:!0,retry:3,retryDelay:1e3}),{data:ne,isError:Le,isLoading:me,refetch:P}=Oe({address:u,abi:qe,functionName:"getOptionTotals",enabled:!0,retry:3,retryDelay:1e3}),{data:W,isError:De,refetch:we}=Oe({address:u,abi:qe,functionName:"getUserStake",args:[d],enabled:!!d}),{data:r,refetch:Me}=Oe({address:u,abi:qe,functionName:"getStakersCount",enabled:!0}),R=s.useCallback(()=>{const t=Date.now();if(t-he.current<2e3)return;he.current=t,["refreshBalance","refreshWalletBalance","forceBalanceRefetch"].forEach(c=>{window.dispatchEvent(new CustomEvent(c,{detail:{source:"usePrediction",timestamp:t}}))}),localStorage.setItem("balanceNeedsRefresh","true"),localStorage.setItem("refreshReason","stake_success"),localStorage.setItem("refreshTimestamp",t.toString()),m.refetchBalance&&m.refetchBalance()},[m]),ge=s.useCallback(()=>{ce(),P(),we(),Me(),m.refetchAllowance(),m.refetchBalance()},[u,ce,P,we,Me,m]),be=s.useCallback(async()=>{try{m.refetchBalance&&await m.refetchBalance(),m.refetchAllowance&&await m.refetchAllowance(),R()}catch(t){console.error("Error refreshing balance:",t)}},[m,R]);s.useEffect(()=>{if(h.isStakeSuccess&&Y&&!te&&(se(!0),n(null),U(null),M(!1),ge(),R(),setTimeout(()=>{R(),be()},3e3),setTimeout(()=>{R(),be()},6e3),window.dispatchEvent(new CustomEvent("stakeSuccess",{detail:{amount:z,option:y,eventAddress:u,timestamp:Date.now()}})),setTimeout(()=>{b(!0)},2e3)),(h.error||m.error)&&Y&&!te){const t=h.error||m.error;n(t),U(h.error),se(!0),M(!1),setTimeout(()=>{b(!0)},500)}},[h.isStakeSuccess,h.error,m.error,te,Y,ge,R,be,z,y,u]),s.useEffect(()=>{if(w){const t=w.toLowerCase(),a=Ne[t];a?(ie(a),console.log("ü™ô Token configuration updated:",{address:w,name:a.name,symbol:a.symbol,decimals:a.decimals})):(console.warn(`‚ö†Ô∏è Unknown token address: ${w}`),ie(Ne["0xdE9e4C3ce781b4bA68120d6261cbad65ce0aB00b".toLowerCase()]))}},[w]),s.useEffect(()=>{if(W&&d){const[t,a,c]=W,f=k(a,0);fe({selectedOption:k(t,0),amount:f,claimed:!!c}),pe(f>0),console.log("üë§ User stake status:",{hasStaked:f>0,selectedOption:k(t,0),amount:f,claimed:!!c})}else pe(!1),fe(null)},[W,d,k]),s.useEffect(()=>{if(i&&(oe||me||!x)){console.log("Using initial event data while blockchain loads...");const t=F(i.tokenAddress);ee(t);const a=t.toLowerCase();Ne[a]||(console.warn(`Unsupported token address in initial data: ${t}`),ee(v));const c={...i,tokenAddress:t,isOpenForBetting:!0,statusMessage:"Loading from blockchain...",isPending:!1,isApproved:!0,isClosed:!1,isCompleted:!1,isCancelled:!1,isRejected:!1,isNullified:!1,hasEnded:!1};I(c),$(!1);return}if(!oe&&!me&&x&&ne)try{const t=T(x[0],"Unknown Question"),a=T(x[1],"No description available"),c=Array.isArray(x[2])?x[2]:["Yes","No"],f=T(x[3],"binary"),q=T(x[4],"general"),Z=T(x[5],""),C=k(x[6],0),Ae=k(x[7],Math.floor(Date.now()/1e3)),ke=k(x[8],0),xe=T(x[9],"0x0"),Ve=T(x[10],v),Je=k(x[11],0),Re=k(x[12],0),de=k(x[13],0),Ye=!!x[14],ye=F(Ve);ee(ye);const $e=ye.toLowerCase();if(!Ne[$e]){ae(`Unsupported token address: ${ye}. Only STIM and USDC are supported.`),$(!1);return}const je=Array.isArray(ne)?ne.map(We=>k(We,0)):[0,0];N(je);const Fe=new Date(Ae*1e3),Be=new Date>=Fe,Pe={question:t,description:a,options:{A:c[0]||"Yes",B:c[1]||"No"},category:typeof(i==null?void 0:i.category)=="object"?i.category:{label:q,id:"0"},status:C,statusMessage:Et[C]||"Unknown status",end_time:Fe,winningOption:ke,creator:xe,tokenAddress:ye,totalStaked:Re,yes_votes:je[0]||0,no_votes:je[1]||0,stakersCount:k(r,0),creatorStake:Je,creatorFeePercentage:de,creatorRewardClaimed:Ye,eventType:f,eventImage:Z,isPending:C===X.PENDING,isApproved:C===X.APPROVED,isOpenForBetting:C===X.APPROVED&&!Be,isClosed:C===X.CLOSED,isCompleted:C===X.COMPLETED,isCancelled:C===X.CANCELLED,isRejected:C===X.REJECTED,isNullified:C===X.NULLIFIED,hasEnded:Be};console.log("üìä Event data processed from blockchain:",{tokenAddress:ye,tokenConfig:Ne[$e],totalStaked:Re,status:Pe.statusMessage,isOpenForBetting:Pe.isOpenForBetting,endTime:Fe,hasEnded:Be}),I(Pe),$(!1),ae(null)}catch(t){console.error("Error processing event data:",t),ae("Error processing event data: "+t.message),$(!1)}if(!oe&&le||!me&&Le){if(console.error("Error loading event data",{eventError:le,totalsError:Le}),i){console.log("Using initial event data due to blockchain error");const t=F(i.tokenAddress);ee(t);const a={...i,tokenAddress:t,statusMessage:"Unable to verify on blockchain",isOpenForBetting:!0};I(a),ae("Unable to verify event status on blockchain, but you can still attempt to stake")}else ae("Failed to load event data from the blockchain");$(!1)}},[x,ne,r,oe,me,le,Le,u,F,v,i,k,T]);const ve=t=>{if(!t)return"0";try{const a=typeof t=="bigint"?t:BigInt(t.toString()),c=Ze(a,S.decimals);console.log("formatTokenAmount debug:",{input:t.toString(),tokenDecimals:S.decimals,tokenSymbol:S.symbol,formatUnitsResult:c});const f=parseFloat(c);return f<1&&f>0?parseFloat(f.toFixed(8)).toString():f.toFixed(2)}catch(a){try{const c=t.toString();let f;if(c.includes("."))f=parseFloat(c);else{const q=Number(c);f=q/Math.pow(10,S.decimals),console.log("Manual conversion fallback:",{input:q,decimals:S.decimals,result:f})}return f<1&&f>0?parseFloat(f.toFixed(8)).toString():f.toFixed(2)}catch{return console.warn("Error formatting token amount:",a,"Amount:",t),"0"}}},Ce=()=>{if(!(p!=null&&p.end_time))return"0 hrs 0 mins left";try{const t=new Date;let a;if(p.end_time instanceof Date)a=p.end_time;else if(typeof p.end_time=="string")a=new Date(p.end_time);else if(typeof p.end_time=="number")a=new Date(p.end_time*1e3);else return console.warn("Invalid end_time format:",p.end_time),"Invalid time";const c=a-t;if(console.log("Time calculation in prediction:",{now:t.toISOString(),endTime:a.toISOString(),timeLeft:c,timeLeftInMinutes:c/(1e3*60),timeLeftInHours:c/(1e3*60*60),timeLeftInDays:c/(1e3*60*60*24)}),c<=0)return"Ended";const f=Math.floor(c/(1e3*60*60*24)),q=Math.floor(c%(1e3*60*60*24)/(1e3*60*60)),Z=Math.floor(c%(1e3*60*60)/(1e3*60));return f>0?`${f}d ${q}h left`:q>0?`${q}h ${Z}m left`:Z>0?`${Z}m left`:"< 1m left"}catch(t){return console.error("Error calculating time left:",t),"Invalid time"}},_e=(t,a=!1)=>{if(!p)return{yesPercentage:0,noPercentage:0};let c=parseFloat(Ze(BigInt(p.yes_votes||0),S.decimals)),f=parseFloat(Ze(BigInt(p.no_votes||0),S.decimals));if(a&&z){const Z=parseFloat(z);t==="optionA"?c+=Z:t==="optionB"&&(f+=Z)}const q=c+f;return q===0?{yesPercentage:50,noPercentage:50}:{yesPercentage:Math.round(c/q*100),noPercentage:Math.round(f/q*100)}},He=t=>{const{yesPercentage:a,noPercentage:c}=_e(t,!0),f=t==="optionA"?a:c,q=f===0?2:100/f,Z=Math.round((q-1)*100);return Math.max(Z,0)},Ge=t=>p?(p.stakersCount||0)+(t?1:0):0;s.useEffect(()=>{const t=j||m.error||h.error;t&&ae(t)},[j,m.error,h.error]);const Te=s.useCallback(()=>{se(!1),b(!1),n(null),U(null),M(!1),V(null),Q(null),D.current=!1,h.clearTransactionState&&h.clearTransactionState(),m.clearError&&m.clearError()},[h,m]),ze=async(t,a,c=null)=>{try{if(D.current)return{success:!1,message:"Transaction already in progress"};if(D.current=!0,Te(),!a||Number.parseFloat(a)<=0)return D.current=!1,{success:!1,message:"Invalid stake amount"};if(!p)return D.current=!1,{success:!1,message:"Event data not loaded"};if(J&&O){if(O.selectedOption!==t)return D.current=!1,{success:!1,message:`You cannot change your prediction. You previously staked ${ve(O.amount)} ${S.symbol} on ${p.options.A==="Yes"?O.selectedOption===0?"Yes":"No":O.selectedOption===0?p.options.A:p.options.B}. You can only add more to the same option.`,opposingChoice:!0};console.log(`üëç User adding to existing ${O.selectedOption===0?"Yes":"No"} stake`)}V(a),Q(t===0?"optionA":"optionB");const f=Ee(a.toString(),S.decimals);if(!p.isOpenForBetting){let C="Event is not accepting stakes";return p.isPending?C="Event is still pending approval. Please wait for moderator approval.":p.isClosed||p.isCompleted?C="This event is closed for betting. Staking is no longer available.":p.isCancelled?C="This event has been cancelled.":p.isRejected?C="This event has been rejected.":p.isNullified?C="This event has been nullified.":p.hasEnded&&(C="Event has already ended. Staking is no longer available."),D.current=!1,{success:!1,message:C,eventClosed:!0}}if(await m.refetchAllowance(),!m.checkIfApproved(a)){let C;const Ae=S.symbol==="USDC";c?C=c:Ae?C=a:C=Math.max(Number.parseFloat(a)*10,1e3).toString(),console.log("üîê Token approval strategy:",{tokenSymbol:S.symbol,isUSDC:Ae,requestedAmount:a,approvalAmount:C,strategy:Ae?"exact amount":"bulk approval",isAdditionalStake:J});const ke=await m.approveToken(C);return ke.success?(D.current=!1,{success:!0,needsConfirmation:!0,message:"Approval submitted, waiting for confirmation..."}):(D.current=!1,{success:!1,message:ke.error||"Token approval failed"})}M(!0);const Z=await h.placeStake(t,a,p,m.userBalance,m.allowance,w,f);return Z.success?{success:!0,needsConfirmation:!0,message:J?"Additional stake transaction submitted!":"Stake transaction submitted!"}:(M(!1),D.current=!1,{success:!1,message:Z.error||"Staking transaction failed"})}catch(f){return console.error("Approve and stake error:",f),M(!1),D.current=!1,{success:!1,message:f.message||"Transaction failed"}}},Ke=s.useCallback(t=>{if(!t||!m.allowance)return!1;try{const a=Ee(t.toString(),S.decimals),c=m.allowance>=a;return console.log("üîç Approval check:",{amount:t,amountInWei:a.toString(),currentAllowance:m.allowance.toString(),isApproved:c,tokenSymbol:S.symbol}),c}catch(a){return console.error("Error checking approval:",a),!1}},[m.allowance,S.decimals,S.symbol]);return{eventData:p,optionTotals:H,tokenAddress:w,tokenConfig:S,userStake:O,hasUserStaked:J,loading:re,error:j,isApproved:m.isApproved,userBalance:m.userBalance,allowance:m.allowance,pendingApproval:m.pendingApproval,pendingStake:h.pendingStake,isApprovalPending:m.isApprovalPending,isApprovalSuccess:m.isApprovalSuccess,isStakePending:h.isStakePending,isStakeSuccess:h.isStakeSuccess,transactionComplete:te,navigationReady:G,transactionError:E,stakingError:L,stakingInProgress:Y,lastStakeAmount:z,lastBetOption:y,approveToken:m.approveToken,placeStake:(t,a)=>h.placeStake(t,a,p,m.userBalance,m.allowance,w,Ee(a.toString(),S.decimals)),refreshEventData:ge,refreshUserBalance:be,checkIfApproved:Ke,approveAndStake:ze,resetTransactionState:Te,formatTokenAmount:ve,getTimeLeft:Ce,calculatePercentages:_e,calculatePotentialWinnings:He,calculateTotalVotes:Ge,clearError:()=>{ae(null),n(null),U(null),m.clearError(),h.clearError()}}},Ie=void 0,Ue={[void 0]:{name:"USDT",symbol:"USDT",decimals:18,icon:et},["0x01C5C0122039549AD1493B8220cABEdD739BC44E".toLowerCase()]:{name:"USDC",symbol:"USDC",decimals:6,icon:kt}},Bt=()=>{var je,Fe,Qe,Be,Pe,We,tt,st,nt;const[u,v]=s.useState(""),[i,d]=s.useState(""),[p,I]=s.useState(!1),[H,N]=s.useState(null),[w,ee]=s.useState(!1),S=s.useRef(null),ie=s.useRef(null),O=mt(),{state:fe}=gt(),{address:J,isConnected:pe}=it(),re=ht(),{switchChain:$}=bt();s.useEffect(()=>{pe&&re&&re!==rt.id&&(_.warn("Switching to Celo Alfajores..."),$({chainId:rt.id}))},[pe,re,$]);const{betOption:j="optionA",predictionId:ae,eventAddress:te,eventData:se,question:G,options:b}=fe||{},E=j==="optionA"?0:1,{eventData:n,userBalance:L,loading:U,error:z,pendingApproval:V,pendingStake:y,isApprovalPending:Q,isStakePending:Y,isStakeSuccess:M,approveAndStake:he,getTimeLeft:D,calculatePotentialWinnings:m,calculateTotalVotes:h,clearError:k,transactionComplete:T,navigationReady:F,resetTransactionState:x,transactionError:le,stakingError:oe,stakingInProgress:ce,lastStakeAmount:ne,lastBetOption:Le,refreshUserBalance:me,hasUserStaked:P,userStake:W,checkIfApproved:De}=Tt(te||"0x0000000000000000000000000000000000000000",Ie,se),we=s.useCallback(()=>{if(S.current){const o=S.current,g=o.scrollHeight,A=o.clientHeight;g>A&&o.scrollTo({top:g-A,behavior:"smooth"})}},[]);s.useEffect(()=>{const o=setTimeout(()=>{we()},100);return()=>clearTimeout(o)},[i,H,u,we]),s.useEffect(()=>{const o=setTimeout(()=>{we()},300);return()=>clearTimeout(o)},[we]);const r=s.useMemo(()=>{const o=n||se||{question:G||"Loading question...",options:b||{A:"Option A",B:"Option B"},category:{label:"Unknown",id:"0"},totalStaked:"0",end_time:new Date().toISOString(),status:1,statusMessage:"Loading..."};return b&&typeof b=="object"&&(o.options=b),console.log("Display Event Data:",o),o},[n,se,G,b]),Me=te&&te!=="0x0000000000000000000000000000000000000000",R=s.useCallback(()=>!P||!W?!1:W.selectedOption!==E,[P,W,E]),ge=s.useCallback(()=>{var g,A;return!P||!W?"":W.selectedOption===0?((g=r.options)==null?void 0:g.A)||"Option A":((A=r.options)==null?void 0:A.B)||"Option B"},[P,W,r.options]),be=s.useCallback(()=>{var o,g;return E===0?((o=r.options)==null?void 0:o.A)||"Option A":((g=r.options)==null?void 0:g.B)||"Option B"},[E,r.options]),ve=s.useCallback((o,g=!1)=>{if(!o||o==="0")return"0";try{const K=((n==null?void 0:n.tokenAddress)||(r==null?void 0:r.tokenAddress)||Ie).toLowerCase(),Se=Ue[K],l=(Se==null?void 0:Se.decimals)||18;let B;const ue=o.toString();return ue.includes(".")?B=parseFloat(ue):B=Number(ue)/Math.pow(10,l),g||B<1&&B>0?parseFloat(B.toFixed(8)).toString():B.toFixed(2)}catch(A){return console.error("Error formatting token amount:",A),"0"}},[n==null?void 0:n.tokenAddress,r==null?void 0:r.tokenAddress]),Ce=s.useCallback(o=>{if(!o)return"0.00";try{const A=((n==null?void 0:n.tokenAddress)||(r==null?void 0:r.tokenAddress)||Ie).toLowerCase(),K=Ue[A],Se=(K==null?void 0:K.decimals)||18,l=o.toString();if(l.includes(".")){const ue=parseFloat(l);return ue<1&&ue>0?ue.toFixed(6):ue.toFixed(2)}const B=Number(l)/Math.pow(10,Se);return B<1&&B>0?parseFloat(B.toFixed(6)).toString():B.toFixed(2)}catch(g){return console.error("Error formatting balance:",g),"0.00"}},[n==null?void 0:n.tokenAddress,r==null?void 0:r.tokenAddress]),_e=s.useCallback(o=>{if(!o)return"0";try{const A=((n==null?void 0:n.tokenAddress)||(r==null?void 0:r.tokenAddress)||Ie).toLowerCase(),K=Ue[A],Se=(K==null?void 0:K.decimals)||18;let l;const B=o.toString();return B.includes(".")?l=parseFloat(B):l=Number(B)/Math.pow(10,Se),l>=1e6?`${(l/1e6).toFixed(1)}M`:l>=1e3?`${(l/1e3).toFixed(1)}K`:l>=1?l.toFixed(2):l>0?parseFloat(l.toFixed(8)).toString():"0"}catch(g){return console.error("Error formatting volume:",g),"0"}},[n==null?void 0:n.tokenAddress,r==null?void 0:r.tokenAddress]),He=s.useCallback(()=>{try{const o=h&&h(j);return o>1e6?Math.max(1,Math.floor(o/1e6)):Math.max(1,o||1)}catch(o){return console.error("Error calculating vote count:",o),1}},[h,j]),Ge=s.useCallback(()=>{if(!n)return{yesPercentage:50,noPercentage:50};try{const o=Number(n.yes_votes||0),g=Number(n.no_votes||0),A=o+g;return A===0?{yesPercentage:50,noPercentage:50}:{yesPercentage:Math.round(o/A*100),noPercentage:Math.round(g/A*100)}}catch(o){return console.error("Error calculating percentages:",o),{yesPercentage:50,noPercentage:50}}},[n]),Te=s.useCallback(()=>{["refreshBalance","refreshWalletBalance","forceBalanceRefetch"].forEach(g=>{window.dispatchEvent(new CustomEvent(g))}),me&&me(),localStorage.setItem("balanceNeedsRefresh","true")},[me]),ze=async(o,g)=>{try{if(!J)return N("Please connect your wallet first"),_.error("Please connect your wallet first"),{success:!1,message:"Please connect your wallet first"};if(!g||Number.parseFloat(g)<=0)return N("Please enter a valid stake amount"),_.error("Please enter a valid stake amount"),{success:!1,message:"Invalid stake amount"};if(!te)return N("Event address not found"),_.error("Event address not found"),{success:!1,message:"Event address not found"};if(P&&R()){const l=ge(),B=be(),ue=`You cannot change your prediction. You previously staked on "${l}" and cannot switch to "${B}".`;return N(ue),_.error(`Cannot switch from "${l}" to "${B}"`),{success:!1,message:ue}}if(!r.isOpenForBetting&&n&&!n.isOpenForBetting){let l="Event is not accepting stakes";return n.isPending?l="Event is still pending approval. Please wait for moderator approval.":n.isClosed||n.isCompleted?l="This event is closed for betting. Staking is no longer available.":n.isCancelled?l="This event has been cancelled.":n.isRejected?l="This event has been rejected.":n.isNullified?l="This event has been nullified.":n.hasEnded&&(l="Event has already ended. Staking is no longer available."),N(l),_.error(l),{success:!1,message:l,eventClosed:!0}}const A=Number.parseFloat(g),K=Ce(L);if(A>Number.parseFloat(K)){const l=`Insufficient balance. You have ${K} ${de}`;return N(l),_.error(l),{success:!1,message:l}}if(N(null),ee(!1),x(),!De(g)){d("Requesting token approval...");try{const l=await he(o,g,g);return l.success||l.needsConfirmation?(d("Approval submitted! Button will update when confirmed."),_.success("Approval transaction submitted! Click the button again to stake after confirmation."),{success:!0,message:"Approval transaction submitted"}):(N(l.message||"Approval failed"),_.error(l.message||"Approval failed"),l)}catch(l){return console.error("Approval error:",l),N("Approval failed: "+l.message),_.error("Approval failed: "+l.message),{success:!1,message:"Approval failed"}}}else{d("Placing your stake...");try{const l=await he(o,g);if(l.success||l.needsConfirmation){const B=P?"Additional stake transaction submitted!":"Stake transaction submitted!";_.success(B),d("Stake submitted! Waiting for confirmation...")}else N(l.message||"Transaction failed"),_.error(l.message||"Transaction failed");return l}catch(l){console.error("Stake error:",l);const B=`Stake failed: ${l.message||"Unknown error"}`;return N(B),_.error(B),{success:!1,message:B}}}}catch(A){console.error("Transaction error:",A);const K=`Transaction failed: ${A.message||"Unknown error"}`;return N(K),_.error(K),{success:!1,message:K}}};s.useEffect(()=>{z&&(N(z.message||"Failed to load event data from the blockchain"),k())},[z,k]),s.useEffect(()=>{const o=setTimeout(()=>I(!0),1e4);return()=>clearTimeout(o)},[]),s.useEffect(()=>{w||F&&T&&(M&&!le&&!oe?(d("Stake placed successfully! Refreshing balance..."),ee(!0),_.success("Stake placed successfully!"),Te(),setTimeout(()=>{Te()},2e3),setTimeout(()=>{Te()},5e3),setTimeout(()=>{O("/prediction-success",{state:{betOption:j,stake:ne||u,predictionId:ae,question:r.question,timeLeft:D(),potentialWinnings:m(j),eventAddress:te,eventData:n||se,betSuccess:!0,isAdditionalStake:P},replace:!0})},1e3)):(le||oe)&&(d("Transaction failed! Please try again."),N(le||oe),_.error(le||oe||"Transaction failed"),ee(!1),setTimeout(()=>{x()},3e3)))},[F,T,M,le,oe,w,O,j,u,ne,ae,r.question,te,n,se,D,m,x,me,P]),s.useEffect(()=>{w||(V||Q?d("Confirming approval..."):y||Y?d("Confirming stake..."):M&&!F?d("Stake successful! Redirecting..."):le||oe?d("Transaction failed. Please try again."):!V&&!y&&!Q&&!Y&&!M&&i&&!i.includes("Success")&&!i.includes("Redirect")&&!i.includes("failed")&&d(""))},[V,y,Q,Y,M,F,le,oe,i,w]);const Ke=s.useCallback(()=>{if(ce||Y||Q){_.warning("Transaction in progress. Please wait...");return}x&&x(),ee(!1),O("/predict")},[ce,Y,Q,x,O]),t=s.useCallback(o=>{const g=o.target.value;/^\d*\.?\d*$/.test(g)&&(v(g),N(null))},[]),a=V||y||Q||Y||ce,c=T&&F,f=le||oe,q=()=>P&&R()?"Cannot Change Prediction":P&&!R()?c?M&&!f?"Success! Redirecting...":f?"Transaction Failed - Retry":"Redirecting...":a?V||Q?"Approving Tokens...":y||Y?"Adding to Stake...":"Processing...":n&&!n.isOpenForBetting?"Event Closed":u&&!De(u)?"Approve Tokens":"Add to Stake":c?M&&!f?"Success! Redirecting...":f?"Transaction Failed - Retry":"Redirecting...":a?V||Q?"Approving Tokens...":y||Y?"Placing Stake...":"Processing...":n&&!n.isOpenForBetting?"Event Closed":u&&!De(u)?"Approve Tokens":"Place Stake",Z=async()=>{if(P&&R()){const o=ge(),g=be(),A=`You cannot change your prediction. You previously staked on "${o}" and cannot switch to "${g}".`;N(A),_.error(`Cannot switch from "${o}" to "${g}"`);return}a||c&&M&&!f||await ze(E,u)},C=n&&!n.isOpenForBetting,Ae=Ce(L),ke=Number.parseFloat(u||"0")<=Number.parseFloat(Ae),xe=P&&R(),Ve=Me&&!xe&&!C&&ke&&u&&Number.parseFloat(u)>0&&!a&&!(c&&M&&!f),Je=s.useCallback(()=>{if(!L)return"0.00";if(ne&&ce){const o=parseFloat(Ce(L)),g=parseFloat(ne);return Math.max(0,o-g).toFixed(2)}return Ce(L)},[L,ne,ce,Ce]),Re=s.useCallback(()=>ne&&ce,[ne,ce]),de=s.useMemo(()=>{const o=(n==null?void 0:n.tokenAddress)||(r==null?void 0:r.tokenAddress)||Ie;if(!o)return"USDT";const g=o.toLowerCase(),A=Ue[g];return A?A.symbol:"USDT"},[n==null?void 0:n.tokenAddress,r==null?void 0:r.tokenAddress]),Ye=s.useCallback(()=>{const o=(n==null?void 0:n.tokenAddress)||(r==null?void 0:r.tokenAddress)||Ie;if(!o)return et;const g=o.toLowerCase(),A=Ue[g];return A?A.icon:et},[n==null?void 0:n.tokenAddress,r==null?void 0:r.tokenAddress]);if(!Me)return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-60",children:e.jsx("div",{className:"w-full max-w-md bg-[#0B122E] rounded-[20px] border-2 border-[#18DDF7] p-6 text-center",children:e.jsxs("div",{className:"text-red-500",children:[e.jsx("p",{className:"mb-4",children:"Invalid Event Address"}),e.jsx("p",{className:"mb-6 text-sm text-gray-400",children:"No event address provided"}),e.jsx("button",{className:"px-4 py-2 bg-[#18DDF7] text-black rounded-full hover:bg-opacity-90",onClick:()=>O("/predict"),children:"Go back"})]})})});if(U&&!(r!=null&&r.question))return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-60",children:e.jsx("div",{className:"w-full max-w-md bg-[#0B122E] rounded-[20px] border-2 border-[#18DDF7] p-6 text-center",children:e.jsxs("div",{className:"text-white",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full border-4 border-t-[#18DDF7] border-r-transparent border-b-transparent border-l-transparent animate-spin mx-auto mb-4"}),e.jsx("p",{children:"Loading prediction details..."})]}),p&&e.jsxs("div",{className:"mt-6",children:[e.jsx("p",{className:"mb-2 text-yellow-400",children:"Taking longer than expected"}),e.jsx("button",{className:"px-4 py-2 bg-[#18DDF7] text-black rounded-full hover:bg-opacity-90",onClick:()=>O("/predict"),children:"Go back"})]})]})})});if(!(r!=null&&r.question))return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-60",children:e.jsx("div",{className:"w-full max-w-md bg-[#0B122E] rounded-[20px] border-2 border-[#18DDF7] p-6 text-center",children:e.jsxs("div",{className:"text-red-500",children:[e.jsx("p",{className:"mb-4",children:"Error loading prediction"}),e.jsx("p",{className:"mb-6 text-sm text-gray-400",children:H||"Event data could not be retrieved"}),e.jsx("button",{className:"px-4 py-2 bg-[#18DDF7] text-black rounded-full hover:bg-opacity-90",onClick:()=>O("/predict"),children:"Go back"})]})})});const{yesPercentage:ye,noPercentage:$e}=Ge();return console.log("Prediction Debug:",{betOption:j,optionValue:E,displayEventData:r.options,yesPercentage:ye,noPercentage:$e,tokenAddress:(n==null?void 0:n.tokenAddress)||(r==null?void 0:r.tokenAddress),tokenSymbol:de,category:r.category}),e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-60",children:e.jsx("div",{ref:S,className:"relative w-full max-w-md bg-[#0B122E] rounded-[20px] border-2 border-[#18DDF7] p-6 max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{ref:ie,children:[e.jsxs("div",{className:"flex items-center justify-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:P&&!R()?"Add to Your Bet":"Place Your Bet"}),e.jsx("button",{className:"absolute right-4 bg-[#1A1F3F] rounded-full p-2 hover:bg-opacity-80",onClick:Ke,disabled:ce||Y||Q,children:e.jsx("img",{src:xt,alt:"close"})})]}),P&&e.jsxs("div",{className:`p-3 rounded-lg mb-4 text-center ${R()?"bg-red-900 bg-opacity-20 text-red-400 border border-red-500/30":"bg-blue-900 bg-opacity-20 text-blue-400 border border-blue-500/30"}`,children:[e.jsx("p",{className:"font-medium",children:R()?"‚ö†Ô∏è Cannot change your prediction":"üí∞ Your existing stake"}),e.jsxs("p",{className:"mt-1 text-sm",children:["You have ",ve(W.amount,!0)," ",de,' staked on "',ge(),'"']}),R()&&e.jsxs("p",{className:"mt-2 text-xs text-red-300",children:['You cannot switch to "',be(),'". You can only add more to your "',ge(),'" stake.']}),!R()&&e.jsx("p",{className:"mt-2 text-xs text-blue-300",children:"You can add more to this stake below"})]}),C&&e.jsx("div",{className:"p-3 mb-4 text-center text-red-400 bg-red-900 rounded-lg bg-opacity-20",children:n.hasEnded?"Event has ended. Staking is no longer available.":`This event is ${((je=r.statusMessage)==null?void 0:je.toLowerCase())||"closed"}.`}),e.jsx(wt,{categoryIcon:e.jsx("div",{className:"w-10 h-10 rounded-sm bg-[#01052D] flex items-center justify-center text-[#18DDF7]",children:e.jsx(yt,{categoryName:(Fe=r.category)==null?void 0:Fe.name,categoryLabel:(Qe=r.category)==null?void 0:Qe.label,className:"w-5 h-5"})}),question:r.question,yesPercentage:ye,noPercentage:$e,votes:He(),timeLeft:D(),showBorder:!0,status:r.statusMessage,optionA:((Be=r.options)==null?void 0:Be.A)||"Option A",optionB:((Pe=r.options)==null?void 0:Pe.B)||"Option B"}),e.jsxs("div",{className:"mt-6 mb-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("label",{className:"block mb-2 text-sm text-gray-400",children:P&&!R()?"Additional Stake":"Stake"}),e.jsxs("span",{className:"block mb-2 text-sm text-gray-400",children:["Balance:"," ",e.jsxs("span",{className:`${ke?"text-gray-300":"text-red-400"} ${Re()?"text-yellow-400":""}`,children:[Je()," ",de,Re()&&" (pending)"]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:u,onChange:t,placeholder:C?"Cannot stake":xe?"Cannot change prediction":P?"Enter additional stake amount":"Enter stake amount",className:`w-full p-3 bg-[#1A1F3F] text-white rounded-xl placeholder-gray-500 ${!ke&&u?"border border-red-500":""} ${C||a||xe||c&&M&&!f?"opacity-50 cursor-not-allowed":""}`,disabled:a||C||xe||c&&M&&!f}),e.jsxs("div",{className:"absolute flex items-center gap-2 transform -translate-y-1/2 right-3 top-1/2",children:[e.jsx("span",{className:"text-gray-400",children:de}),e.jsx("img",{src:Ye(),alt:de,className:"w-6 h-6"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between mb-6 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-transparent bg-clip-text bg-gradient-to-r from-[#00FFFF] to-[#27FE60]",children:[e.jsx("img",{src:Ye(),alt:de,className:"w-4 h-4"}),e.jsxs("span",{children:[_e(r.totalStaked)," Volume"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-transparent bg-clip-text bg-gradient-to-r from-[#00FFFF] to-[#27FE60]",children:[e.jsx("img",{src:vt,alt:"star icon"}),e.jsxs("span",{children:[m(j),"% Potential Winnings"]})]})]}),e.jsxs("div",{className:"bg-[#1A1F3F] p-3 rounded-xl mb-6 flex justify-between items-center",children:[e.jsxs("div",{className:"text-white",children:[e.jsx("span",{className:"text-sm text-gray-400",children:P&&!R()?"Adding to prediction:":"Your prediction:"}),e.jsx("p",{className:"font-semibold",children:j==="optionA"?((We=r.options)==null?void 0:We.A)||"Option A":((tt=r.options)==null?void 0:tt.B)||"Option B"})]}),e.jsx("div",{className:`px-4 py-1 rounded-full ${j==="optionA"?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"} ${xe?"opacity-50":""}`,children:j==="optionA"?((st=r.options)==null?void 0:st.A)||"Option A":((nt=r.options)==null?void 0:nt.B)||"Option B"})]}),e.jsx("div",{className:"mb-4",children:e.jsx("button",{className:`w-full py-4 rounded-full font-semibold transition-colors ${Ve?M&&c&&!f?"bg-green-600 text-white":f&&c?"bg-red-600 text-white hover:bg-red-500":xe?"bg-red-600 text-white cursor-not-allowed":P&&!R()?"bg-blue-600 text-white hover:bg-blue-500":"bg-[#18DDF7] text-black hover:bg-opacity-90":"bg-[#1A1F3F] text-gray-400 cursor-not-allowed"}`,disabled:!Ve&&!(f&&c),onClick:Z,children:q()})}),(i||H)&&e.jsx("div",{className:`text-center mb-4 p-3 rounded-lg ${H?"bg-red-900 bg-opacity-20 text-red-500":i.includes("Success")||i.includes("successful")?"bg-green-900 bg-opacity-20 text-green-500":i.includes("failed")||i.includes("Failed")?"bg-red-900 bg-opacity-20 text-red-500":(i.includes("Refreshing"),"bg-blue-900 bg-opacity-20 text-blue-400")}`,children:H||i}),ne&&ce&&e.jsxs("div",{className:"p-3 mb-4 border rounded-lg bg-yellow-500/10 border-yellow-500/30",children:[e.jsxs("p",{className:"text-sm text-center text-yellow-400",children:["üîÑ Processing ",P?"additional ":"","stake of"," ",ne," ",de," on ",Le,"..."]}),e.jsx("p",{className:"mt-1 text-xs text-center text-yellow-300",children:"Balance will update after transaction confirms"})]}),P&&!R()&&u&&e.jsxs("div",{className:"p-3 mb-4 border rounded-lg bg-blue-500/10 border-blue-500/30",children:[e.jsxs("p",{className:"text-sm text-center text-blue-400",children:[`üí° You're adding to your existing "`,ge(),'" stake']}),e.jsxs("p",{className:"mt-1 text-xs text-center text-blue-300",children:["Total stake will be:"," ",ve(W.amount,!0)," +"," ",u||"0"," ="," ",W&&u?(parseFloat(ve(W.amount,!0))+parseFloat(u||"0")).toString():ve((W==null?void 0:W.amount)||0,!0)," ",de]})]})]})})})};export{Bt as default};
